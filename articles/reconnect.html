<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Disconnected, Reconnect and Reload • shinyMobile</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Disconnected, Reconnect and Reload">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/atropos@2.0.2/atropos.min.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-info" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinyMobile</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/shinyMobile.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/inputs-layout.html">Inputs Layout and Forms</a></li>
    <li><a class="dropdown-item" href="../articles/lists.html">List View</a></li>
    <li><a class="dropdown-item" href="../articles/multipages.html">Multipages</a></li>
    <li><a class="dropdown-item" href="../articles/pwa.html">Progressive Web App (PWA) support</a></li>
    <li><a class="dropdown-item" href="../articles/reconnect.html">Disconnected, Reconnect and Reload</a></li>
    <li><a class="dropdown-item" href="../articles/shinyMobile-tools.html">shinyMobile Tools</a></li>
    <li><a class="dropdown-item" href="../articles/update-app.html">Dynamic App Configuration</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 2.0.1</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 2.0.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 1.0.1</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 1.0.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 0.9.1</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 0.9.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 0.8.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 0.7.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>shinyMobile 0.1.0</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RinteRface/shinyMobile/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Disconnected, Reconnect and Reload</h1>
            
            <h4 data-toc-skip class="date">2024-10-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/RinteRface/shinyMobile/blob/master/vignettes/reconnect.Rmd" class="external-link"><code>vignettes/reconnect.Rmd</code></a></small>
      <div class="d-none name"><code>reconnect.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="custom-disconnected-screen">Custom disconnected screen<a class="anchor" aria-label="anchor" href="#custom-disconnected-screen"></a>
</h2>
<p>Nobody likes it when an app stops responding. Traditionally, Shiny
apps will be “grayed out”. Since this doesn’t provide a nice user
experience, <a href="https://github.com/RinteRface/shinyMobile" class="external-link">shinyMobile</a> adds a custom disconnected
screen. This screen (a toast) is displayed when the app is disconnected
from the server.</p>
<div class="text-center mt-4">
<p><a class="btn btn-primary" data-bs-toggle="collapse" href="#reconnect" role="button" aria-expanded="false" aria-controls="singleLayout">
Code </a></p>
</div>
<div id="reconnect" class="collapse">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RinteRface/shinyMobile" class="external-link">shinyMobile</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="fu"><a href="../reference/f7Page.html">f7Page</a></span><span class="op">(</span></span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dark <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"My app"</span>,</span>
<span>    <span class="fu"><a href="../reference/f7SingleLayout.html">f7SingleLayout</a></span><span class="op">(</span></span>
<span>      navbar <span class="op">=</span> <span class="fu"><a href="../reference/navbar.html">f7Navbar</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Custom disconnected screen"</span>,</span>
<span>        hairline <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/f7List.html">f7List</a></span><span class="op">(</span></span>
<span>        inset <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        dividers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        strong <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="fu"><a href="../reference/text.html">f7Text</a></span><span class="op">(</span></span>
<span>          inputId <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>          label <span class="op">=</span> <span class="st">"Text input"</span>,</span>
<span>          value <span class="op">=</span> <span class="st">"Some text"</span>,</span>
<span>          placeholder <span class="op">=</span> <span class="st">"Your text here"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/select.html">f7Select</a></span><span class="op">(</span></span>
<span>            inputId <span class="op">=</span> <span class="st">"select"</span>,</span>
<span>            label <span class="op">=</span> <span class="st">"Make a choice"</span>,</span>
<span>            choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>            selected <span class="op">=</span> <span class="fl">1</span></span>
<span>          <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/block.html">f7Block</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/button.html">f7Button</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="st">"disconnect"</span>,</span>
<span>                 label <span class="op">=</span> <span class="st">"Disconnect me"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/block.html">f7Block</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">"mytext"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">"myselect"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># set ignoreInit to avoid the observer being triggered after reconnect</span></span>
<span>    <span class="co"># this happens because of restoring the app's state</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">disconnect</span>, ignoreInit <span class="op">=</span> <span class="cn">TRUE</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">disconnect</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Oops, I disconnected you!"</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">mytext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">input</span><span class="op">$</span><span class="va">text</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">myselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">input</span><span class="op">$</span><span class="va">select</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>The user is given two options: either to <strong>reconnect</strong>
or to <strong>reload</strong> the app. There’s a subtle difference
between the two, which is explained below.</p>
</div>
<div class="section level2">
<h2 id="reconnect">Reconnect<a class="anchor" aria-label="anchor" href="#reconnect"></a>
</h2>
<p>This button will attempt to reconnect to the server. If the server is
not available, or encounters an error again, the custom disconnected
screen will be displayed again.</p>
<p><br></p>
<p>When reconnecting, Shiny attempts to restore the app to its previous
state. This means that the app will be in the same state as before the
disconnection. In the above code, this means
<code>input$disconnect</code>, <code>input$text</code> and
<code>input$select</code> will be restored to their previous values. The
user actually doesn’t see that they are “restored”: it looks like the
user never left. But it is important to realize that behind the scenes,
Shiny is starting from the initial state of your app and sets back the
values of the inputs to their previous values. This means observers and
reactive expressions will be triggered again. In the code above, we’re
using <code>ignoreInit</code> to avoid the observer being triggered
after reconnect. If we would omit this, we would end up being
disconnected again. After all, the value of
<code>input$disconnect</code> changes from <code>0</code> to
<code>1</code> when clicked.</p>
<p><br></p>
<p>Note that the JS code behind the reconnect button ignores the user <a href="https://shiny.rstudio.com/articles/reconnecting.html" class="external-link">reconnect
setup</a> and proposes reconnecting regardless of the
<code>session$allowReconnect</code> configuration. A solution is
provided in the <a href="https://unleash-shiny.rinterface.com/mobile-going-further#enhance-the-disconnect-screen" class="external-link">Outstanding
User Interfaces with Shiny</a> book.</p>
</div>
<div class="section level2">
<h2 id="reload">Reload<a class="anchor" aria-label="anchor" href="#reload"></a>
</h2>
<p>The custom disconnected screen also includes a reload button. This
button will reload the app (like hitting refresh in your browser). This
is useful when the app is stuck in a loop and the reconnect button
doesn’t work. Compared to reconnecting, reloading will start from a
clean slate: there’s no restoring of values.</p>
<p><br></p>
<p>Note that when setting your app up to be a PWA, there’s an
<code>offline.html</code> asset generated when using
<code>charpente::set_pwa()</code>. This page will be displayed when the
user is offline. This page contains a reload button that will reload the
app. It is not reconnecting.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Granjon, Veerle van Leemput, AthlyticZ, Victor Perrier, Isabelle Rudolf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
